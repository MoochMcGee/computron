# vm.conf
# virtual machine configuration file

# What manner of CPU are we simulating?
# Available options are currently:
# 0: 8086
# 1: 80186
cpu 1

# Memory size (only 10-base number in here)
memory 640

# Load files into virtual memspace
loadfile bios/bios.bin F000:0000
loadfile testos/kernel 07C0:0000

# Prepare drive image(s)
#
# DISK TYPES
#  160kB: 0008 0001 0140 0200 (type ??)
#  320kB: 0008 0002 0280 0200 (type ??)
#  360kB: 0009 0002 02D0 0200 (type 01)
#  720kB: 0009 0002 05A0 0200 (type 03)
# 1440kB: 0012 0002 0B40 0200 (type 04)
#
# SYNTAX: drive # /path/to/image SectorsPerTrack Heads Sectors SectorSize Type
#

#drive 0 images/CPM86B.144			0012 0002 0B40 0200 04
drive 0 testos/kernel			0012 0002 0B40 0200 04
drive 1 testos/floppeh			0012 0002 0B40 0200 04
#drive 0 elks-old/boot			0012 0002 0B40 0200 04
#drive 1 elks-old/root			0012 0002 0B40 0200 04
#drive 0 images/full3			0012 0002 0B40 0200 04
drive 0 images/msdos-6.22			0012 0002 0B40 0200 04
#drive 0 images/dos60-1.img			0012 0002 0B40 0200 04
#drive 0 images/dos33-1.ima          0009 0002 02D0 0200 00
#drive 1 images/dos33-2.ima          0009 0002 02D0 0200 00

# Install software interrupts
addint 1E 820E:0503

# Shove some nifty bytes here and there

# Floppy DBT
setbyte 820E:0503 00 00 10 02 12 0A FF 0C AA 10 10 10
# Fixed DBT
setbyte 820E:04F8 00 00 10 02 3F 00 00 AA 10 10

setbyte 40:49 3

# PrintScreen Error:
setbyte 0050:0000 FF
# Machine ID - FE 00 = IBM XT(82) (go with FF 00 for orig. IBMPC)
setbyte F000:FFFE FE 00
# BIOS date (well, why not?) (11/02/03 ;))
setbyte F000:FFF5 31 31 2F 30 31 2F 30 33
# BIOS BOOT CODE <<< VERY IMPORTANT! NO MESSING! >>>
setbyte F000:FFF0 EA 00 00 00 F0
# BDA Video Columns
setbyte 0040:004A 50 00

# Set up default stack
#setstack 9000:FFFF

# Set flags to default values (IF=1)
setflags 7202

# Initialize CS:IP
entry F000:FFF0

