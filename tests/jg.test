asm
	_breg_breg:
		mov al, 0x30
		mov ah, 0x20
		cmp al, ah
		jg _wreg_wreg
		hlt
	_wreg_wreg:
		mov dx, 0x1000
		mov ax, 0x0239
		mov bx, 0x3000
		cmp bx, ax
		jg _wreg_bimm
		hlt
	_wreg_bimm:
		or dx, 0x0230
		mov cx, 0x0030
		cmp cx, byte 0x10
		jg _breg_bimm
		hlt
	_breg_bimm:
		mov di, 0x1000
		shl di, 2
		or di, 0x1000	; DI should be 0x5000
		mov bl, 0x7f
		cmp bl, 0x00
		jg _breg_bimm2
		hlt
	_breg_bimm2:
		or di, 0x0400	; DI should be 0x5400
		mov si, 0x0022
		cmp si, byte 0x21
		jg _wreg_bimm2
		hlt
	_wreg_bimm2:
		add di, 0x270	; DI should be 0x5670
		mov ax, 0x1000
		cmp ax, 0xff
		jg _success
		hlt
	_success:
		add dx, 4		; DX should be 0x1230
		or di, 0x08		; DI should be 0x5670
_asm

result
	DX=1234
	DI=5678
_result
